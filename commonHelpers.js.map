{"version":3,"file":"commonHelpers.js","sources":["../src/img/empty_cart/empty-cart-desktop-1x.png","../src/img/empty_cart/empty-cart-desktop-2x.png","../src/img/empty_cart/empty-cart-tab-1x.png","../src/img/empty_cart/empty-cart-tab-2x.png","../src/img/empty_cart/empty-cart-mob-1x.png","../src/img/empty_cart/empty-cart-mob-2x.png","../src/js/markup_cart.js","../src/js/cart_products.js"],"sourcesContent":["export default \"__VITE_ASSET__0fb79dcc__\"","export default \"__VITE_ASSET__23d539d9__\"","export default \"__VITE_ASSET__ad0906b6__\"","export default \"__VITE_ASSET__a95b529b__\"","export default \"__VITE_ASSET__032cbbaa__\"","export default \"__VITE_ASSET__c571d517__\"","import icons from '../img/symbol-defs.svg';\nimport imgecd_1x from '../img/empty_cart/empty-cart-desktop-1x.png';\nimport imgecd_2x from '../img/empty_cart/empty-cart-desktop-2x.png';\nimport imgect_1x from '../img/empty_cart/empty-cart-tab-1x.png';\nimport imgect_2x from '../img/empty_cart/empty-cart-tab-2x.png';\nimport imgecm_1x from '../img/empty_cart/empty-cart-mob-1x.png';\nimport imgecm_2x from '../img/empty_cart/empty-cart-mob-2x.png';\n\nexport const getEmptyCartMarkup = () =>\n  `<div class=\"empty-cart\">\n      <div class=\"empty-picture\">\n      <picture>\n          <source\n            srcset=\"\n              ${imgecd_1x} 1x,\n              ${imgecd_2x} 2x\n            \"\n            media=\"\n            (min-width: 1440px)\"\n          />\n          <source\n            srcset=\"\n              ${imgect_1x} 1x,\n              ${imgect_2x} 2x\n            \"\n            media=\"\n            (min-width: 768px)\"\n          />\n          <source\n            srcset=\"\n             ${imgecm_1x} 1x,\n              ${imgecm_2x} 2x\n            \"\n            media=\"\n            (min-width: 375px)\"\n          />\n          <img\n            src=\"/img/empty_cart/empty-cart-mob-1x.png\"\n            alt=\"Empty Cart Image\"\n            class=\"empty-cart-image\"\n            loading=\"lazy\"\n          />\n        </picture>\n        </div>\n        <div class=\"empty-text\">\n        <h2 class=\"empty-cart-title\">\n          Your basket is <span class=\"empty-cart-title-span\">empty...</span>\n        </h2>\n        <p class=\"empty-cart-text\">\n          Go to the main page to select your favorite products and add them to\n          the cart.\n        </p></div></div>\n    `;\n\nexport const getCartMarkup = products =>\n  `\n  \n     <div class=\"delete-all\">\n    <button type=\"button\" class=\"btn-delete-all\" aria-label=\"Delete All\"> Delete All \n      <span class=\"icon-close\">\n        <svg class=\"btn-x\" width=\"24\" height=\"24\">\n          <use href=\"${icons}#icon-ion_close-sharp\"></use>\n        </svg>\n      </span>\n    </button>\n  </div>\n  <ul class=\"cart-products-list\">\n    ${products\n      .map(\n        ({ _id, name, img, category, size, price }) => `\n      <li class=\"cart-product-item\" data-product-id=\"${_id}\">\n        <div class=\"cart-product-container\">\n          <div class=\"cart-product-img-container\">\n            <img src=\"${img}\" alt=\"${name}\" width=\"64\" height=\"64\" class=\"cart-product-img\" loading=\"lazy\">\n          </div>\n          <div class=\"cart-product-parameter-container\">\n            <h2 class=\"cart-product-title\">${name}</h2>\n            <div class=\"cart-product-parameter-text\">\n            <p class=\"cart-product-parameter\">Category: <span class=\"cart-span-parameter-value\">${\n              category ? category.replace(/_/g, ' ') : ''\n            }</span></p>\n            <p class=\"cart-product-parameter\">Size: <span class=\"cart-span-parameter-value\">${size}</span></p>\n            </div>\n            <p class=\"price\">$${price}</p>\n          </div>\n          <div class=\"cart-delete\">\n            <button type=\"button\" class=\"cart-btn-delete\" aria-label=\"Delete\">\n              <span class=\"cart-icon-close\">\n                <svg class=\"icon-close\" width=\"18\" height=\"18\">\n                  <use href=\"${icons}#icon-ion_close-sharp\"></use>\n                </svg>\n              </span>\n            </button>\n          </div>\n        </div>\n      </li>`\n      )\n      .join('')}\n  </ul>\n  \n`;\n\nexport const getcheckoutMarkup = (products) =>{\n  \n        return`\n    \n      <h2 class=\"checkout-title\">Your order</h2>\n      <div class=\"checkout-total-wrap\">\n        <p class=\"checkout-text\">Total</p>\n        <p class=\"checkout-total\">$${products.toFixed(2)}</p>\n      </div>\n\n      < class=\"checkout-input-wrap\">\n        <label class=\"checkout-input-label\" for=\"checkoutEmail\"></label>\n        <input\n          class=\"checkout-input-email\"\n          type=\"email\"\n          id=\"checkoutEmail\"\n          name=\"email\"\n          placeholder=\"example@mail.com:\"\n          required\n        />\n        <button class=\"checkout-button\" type=\"submit\" aria-label=\"Proceed to Checkout\">Checkout</button>\n        \n        `};\n\n","import ApiService from './requests';\nimport { ShopStorage } from './local-storage';\nimport {\n  getEmptyCartMarkup,\n  getCartMarkup,\n  getcheckoutMarkup,\n} from './markup_cart';\nimport { updateCartCounter} from './header';\n\nconst basket = document.querySelector('.container-div-cart-js-one');\nconst basketChek = document.querySelector('.container-div-cart-js-two');\nconst cartTitle = document.getElementById('cart-counter-page');\nconst storage = new ShopStorage('productsBasket');\nconst api = new ApiService();\n\nasync function updateCart() {\n  const products = storage.getAllProducts();\n  // console.log('Current products in storage:', products); //проверка\n  // Формування розмітки контейнерів. якщо кошик порожній відмальовується Empty, у іншову випадку відмальовується розмітка CART\n  if (products.length === 0) {\n    // console.log('Basket is empty. Displaying empty cart markup.'); //проверка\n    basket.innerHTML = '';\n    basketChek.innerHTML = '';\n    basket.insertAdjacentHTML('beforeend', getEmptyCartMarkup());\n    // basketChek.insertAdjacentHTML('beforeend', getEmptyCartMarkup());пустой кошик рендерить\n  } else {\n    const productDetailsPromises = products.map(async ({ _id, quantity }) => {\n      try {\n        if (_id) {\n          const productDetails = await api.getProductById(_id);\n          return { ...productDetails, quantity };\n        } else {\n          console.error('_id is undefined or empty for a product in the cart');\n          return null;\n        }\n      } catch (error) {\n        console.error(`Error fetching product details for _id: ${_id}`, error);\n        return null;\n      }\n    });\n\n    const productDetailsArray = await Promise.all(productDetailsPromises);\n     const validProductDetails = productDetailsArray.filter(\n      details => details !== null\n    );\n    basket.innerHTML = '';\n    basket.insertAdjacentHTML('beforeend', getCartMarkup(validProductDetails));\n//  $$=====###33@@@@@@@@@@@@@@@@@@@@@\n    async function calculateTotalPrice(validProductDetails) {\n      let prices = 0;\n      validProductDetails.forEach(({ price }) => (prices += price));\n      return prices;\n    };\n    const totalPrice = await calculateTotalPrice(validProductDetails);\n    basketChek.innerHTML = '';\n    basketChek.insertAdjacentHTML('beforeend', getcheckoutMarkup(totalPrice));\n    async function getCarMarku() {\n      const refs = {\n        totalPriceElement: document.querySelector('.checkout-total'),\n        emailInput: document.querySelector('.checkout-input-email'),\n        checkoutButton: document.querySelector('.checkout-button'),\n        cartContainer: document.querySelector('.cart-products-list'),\n        price: document.querySelector('.price'),\n      };\n      return refs\n   } \nconst {totalPriceElement, emailInput, checkoutButton, cartContainer, price} = await getCarMarku();\n    \n   checkoutButton.addEventListener('click', handleCheckout);\n  function handleCheckout(event) {\n    event.preventDefault();\n    checkout();\n  }\n\n // Функція чекаута\n function checkout() {\n  const emailValue = emailInput.value;\n\n  // Валідація в інпуті\n  if (!emailValue || !isValidEmail(emailValue)) {\n    alert('Please enter a valid email address.');\n    return;\n  }\n  function carMar() {\n    const cartMarkup = getEmptyCartMarkup();\n    cartContainer.innerHTML = cartMarkup;\n\n    }\n  // Завантажує правильну розмітку: або порожню корзину, або товари й ціну\n  if( products.length > 0) carMar();\n \n \n\n  // Повідомлення про успішний чекаут\n  alert(`Checkout completed! Total Price: $${totalPrice.toFixed(2)}.`);\n\n  // Скидає в нуль\n  totalPriceElement.textContent = '0.00';\n \n  // Чистить сховище\n  storage.removeAllProducts();\n  updateCartCounter ();\n  updateCart();\n}\n\n\n// !!!!!!\n// Валідація пошти\nfunction isValidEmail(email) {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n}\n\n\n   totalPriceElement.textContent = totalPrice.toFixed(2);\n   //  $$=====###33@@@@@@@@@@@@@@@@@@@@@\n  }\n  const productCount = products.length;\n  cartTitle.textContent = `CART (${productCount})`;\n \n}\n\n// !=================================================\n\n updateCart();\n  \n\n// !=================================================\ndocument.addEventListener('DOMContentLoaded', () => {\n  document.body.addEventListener('click', async event => {\n    const btnDeleteAll = event.target.closest('.btn-delete-all');\n    const btnDelete = event.target.closest('.cart-btn-delete');\n    if (btnDeleteAll) {\n      // console.log('Deleting all products from storage.');\n      storage.removeAllProducts();\n      // console.log('Updating cart after removing all products.');\n      updateCart();\n    } else if (btnDelete) {\n      const productId =\n        btnDelete.closest('.cart-product-item').dataset.productId;\n      // console.log(`Deleting product with ID: ${productId}`);\n      storage.removeProduct(productId); // ИЗМЕНЕНИЕ\n      updateCart();\n    }\n\t updateCartCounter ();\n  });\n});\n"],"names":["imgecd_1x","imgecd_2x","imgect_1x","imgect_2x","imgecm_1x","imgecm_2x","getEmptyCartMarkup","getCartMarkup","products","icons","_id","name","img","category","size","price","getcheckoutMarkup","basket","basketChek","cartTitle","storage","ShopStorage","api","ApiService","updateCart","handleCheckout","event","checkout","emailValue","emailInput","isValidEmail","carMar","cartMarkup","cartContainer","totalPrice","totalPriceElement","updateCartCounter","email","productDetailsPromises","quantity","error","validProductDetails","details","calculateTotalPrice","prices","getCarMarku","checkoutButton","productCount","btnDeleteAll","btnDelete","productId"],"mappings":"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"}