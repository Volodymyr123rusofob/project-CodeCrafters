var q=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var w=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)};var m=(s,e,t)=>(q(s,e,"access private method"),t);/* empty css                      */import{a as i,S as b,P as N,N as h}from"./assets/vendor-c5b37fd0.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();const T="cart",O=document.querySelector("#cart-counter"),U=s=>{try{const e=localStorage.getItem(s);return e===null?void 0:JSON.parse(e)}catch(e){console.error("Get state error: ",e.message)}},j=U(T)??[];O.textContent=`(${j.length})`;const f="/project-CodeCrafters/assets/symbol-defs-011caa0e.svg";function L(s){return s.map(({_id:e,name:t,img:r,category:o,price:a,size:n,popularity:d})=>`
            <li class="product-item" data-product-id='${e}'>
              <div class="product-img-container">
                <a class="products-card-link" href="">
                  <img src="${r}" alt="${t}" width="140" height="140" class="product-img">
                </a>
              </div>
                <a class="products-card-link" href="">
                  <h3 class="product-title">${t}</h3>
                </a>
              <div class="product-parameter-container">
                <p class="product-parameter">Category: <span class="span-parameter-value"> ${o.replace(/_/g," ")}</span></p>
                <p class="product-parameter">Size: <span class="span-parameter-value"> ${n}</span></p>
                <p class="product-parameter popularity">Popularity: <span class="span-parameter-value"> ${d}</span></p>
                </div>
              <div class="price-card-container">
                <p class="price">$${a}</p>
                <button class="cart-button" type="button" data-item-id="${e}" data-in-cart="false">
                  <svg class="cart-icon" width="18" height="18">
                    <use href="${f}#icon-basket"></use>
                  </svg>
                </button>
              </div>
            </li>
            `).join("")}class y{constructor(){this.BASE_URL="https://food-boutique.b.goit.study/api"}async getProductsByName(e,t,r=1,o=6){const a=new URLSearchParams({keyword:e,category:t,page:r,limit:o});try{return(await i.get(`${this.BASE_URL}/products?${a}`)).data}catch{throw console.error("Помилка при отриманні продуктів:",error.message),error}}async getAllProducts(e=1,t=6){try{return(await i.get(`${this.BASE_URL}/products`,{params:{page:e,limit:t}})).data}catch(r){throw console.error("Помилка при отриманні всіх продуктів:",r.message),r}}async getPopularProducts(e){try{const t={limit:e};return(await i.get(`${this.BASE_URL}/products/popular`,{params:t})).data}catch(t){throw console.error("Помилка при отриманні популярних продуктів:",t.message),t}}async getDiscountedProducts(){try{return(await i.get(`${this.BASE_URL}/products/discount`)).data}catch(e){throw console.error("Помилка при отриманні продуктів зі знижкою:",e.message),e}}async getProductsByCategory(){try{return(await i.get(`${this.BASE_URL}/products/categories`)).data}catch(e){throw console.error("Помилка при отриманні продуктів за категорією:",e.message),e}}async getProductsInCategories(e,t=1,r=6){try{const o=new URLSearchParams({category:e,page:t,limit:r});return(await i.get(`${this.BASE_URL}/products?${o}`)).data}catch(o){throw console.error("Помилка при отриманні продуктів за категорією(при оновленні сторінки): ",o.message),o}}async getProductById(e){try{return(await i.get(`${this.BASE_URL}/products/${e}`)).data}catch(t){throw console.error("Помилка при отриманні продукта за айді:",t.message),t}}async createNewOrder(e){try{return(await i.post(`${this.BASE_URL}/orders`,e)).data}catch(t){throw console.error("Помилка при створенні нового замовлення:",t.message),t}}async createSubscription(e){try{return(await i.post(`${this.BASE_URL}/subscriptions`,{email:e})).data}catch(t){throw console.error("Помилка при створенні підписки:",t.message),t}}}var l,g;class P{constructor(e){w(this,l);this.storageBasketName=e,this.initStorage()}initStorage(){this.getAllProducts()||m(this,l,g).call(this,[])}getAllProducts(){return JSON.parse(localStorage.getItem(this.storageBasketName))}addProduct(e){if(!e)return;const t=this.getAllProducts(),r=t.find(o=>o._id===e._id);r?r.amount+=1:(e.amount=1,t.push(e)),m(this,l,g).call(this,t)}removeProductById(e){const t=this.getAllProducts(),r=t.find(o=>o._id===e);if(r)r.amount>1?r.amount-=1:t.filter(o=>o._id===r._id);else return;m(this,l,g).call(this,t)}removeAllProductsById(e){m(this,l,g).call(this,this.getAllProducts().filter(t=>t._id===e))}removeAllProducts(){m(this,l,g).call(this,[])}removeProduct(e){const r=this.getAllProducts().filter(o=>o._id!==e);m(this,l,g).call(this,r)}}l=new WeakSet,g=function(e){localStorage.setItem(this.storageBasketName,JSON.stringify(e))};const p=document.querySelector(".modal-prod-wrapper"),F="cart",k=new P(F),H=new y;async function D(s){p.classList.add("modal-active"),p.classList.add("loader");const e=await H.getProductById(s);p.classList.remove("loader"),z(e),J(e)}function J(s){const e=document.querySelector(".modal-prod-add-text"),t=s._id;k.getAllProducts().some(o=>o.productId===t)?e.textContent="Remove from":e.textContent="Add to"}function z(s){try{p.classList.add("modal-active"),document.body.classList.add("stop-scroll"),p.innerHTML=`
  <div class="modal-prod-card">
  <button type="button" class="modal-prod-close-btn">
    <svg class="modal-prod-close-icon" width="22" height="22">
      <use href="${f}#icon-ion_close-sharp"></use>
    </svg>
  </button>
  <div class="modal-prod-information-wrap">
  <div class="modal-prod-img-wrap">
      <img class="modal-prod-img" src="${s.img}" alt="${s.name}" />
  </div>
  <div class="modal-prod-name-wrap">
  <p class="modal-prod-name">${s.name}</p>
  <ul class="modal-prod-list">
    <li class="modal-prod-item">
      <p class="modal-prod-text">Category: <span>${s.category}</span></p>
    </li>
    <li class="modal-prod-item">
      <p class="modal-prod-text">Size: <span>${s.size}</span></p>
    </li>
    <li class="modal-prod-item">
      <p class="modal-prod-text">Popularity: <span>${s.popularity}</span></p>
    </li>
  </ul>
  <p class="modal-prod-desc">${s.desc}</p>
  </div>
  </div>
  <div class="modal-prod-price-elem">
  <p class="modal-prod-price">&#36;${s.price}</p>
  <button class="modal-prod-add-btn" >
      <p class="modal-prod-add-text">Add to</p>
      <svg class="modal-prod-basket-icon" >
        <use href="${f}#icon-basket"></use>
      </svg>
  </button>
  </div>
  </div>
  `,document.querySelector(".modal-prod-add-btn").addEventListener("click",()=>G(s)),document.querySelector(".modal-prod-close-btn").addEventListener("click",()=>v()),window.addEventListener("click",E),window.addEventListener("keydown",B)}catch(e){console.error(e)}}function G(s){const e=s._id,r=k.getAllProducts().some(a=>a.productId===e),o=document.querySelector(".modal-prod-add-text");r?o.textContent="Add to":(o.textContent="Remove from",x(o,e))}function v(){document.body.classList.remove("stop-scroll"),p.classList.remove("modal-active"),p.innerHTML="",window.removeEventListener("click",E),window.removeEventListener("keydown",B)}function E(s){s.target===p&&v()}function B(s){s.keyCode===27&&v()}function K(){b.fire({title:"",text:"The product has been added to the cart!",icon:"success",confirmButtonColor:"#6d8434"})}const C=document.querySelector(".js-products-list");C.addEventListener("click",oe);const V=new y,W=6,$=new P("cart"),Y=`<svg class="cart-icon" width="18" height="18">
<use href="${f}#icon-check"></use>
</svg>`,Q=`<svg class="cart-icon" width="18" height="18">
<use href="${f}#icon-basket"></use>
</svg>`;async function X(){const e=(await V.getAllProducts()).results.slice(0,W);I(e,C),ee()}function I(s,e){e.innerHTML=L(s)}const Z=$.getAllProducts();function ee(){S()}function S(){const s=document.querySelectorAll(".cart-button");s&&s.forEach(e=>{e.addEventListener("click",te)})}function te(s){const e=s.target.closest(".cart-button");if(e){const t=e.dataset.itemId;x(e,t),K()}}function x(s,e,t,r){Z.findIndex(a=>a._id===e)!==-1?b.fire({title:"",text:"This product has already been added to the cart!",icon:"warning",confirmButtonColor:"#6d8434"}):$.addProduct({_id:e,amount:1}),se(s,!0)}function se(s,e){if(e){s.innerHTML=Y;const t=document.querySelector(".cart-button");t.disabled=!0}else s.innerHTML=Q}X();function oe(s){s.preventDefault();const e=s.target;if(console.log(e),e.closest("a")&&e.closest(".products-card-link")){const t=e.closest("li").dataset.productId;D(t).catch(r=>{console.error("Помилка при отриманні продукта за айді:",r.message)})}}document.addEventListener("DOMContentLoaded",async()=>{localStorage.setItem("noResultsMessageDisplayed","false");const s=new y,e=document.querySelector(".category-select");try{const a=await s.getProductsByCategory();a.push("Show all"),a.forEach(n=>{const d=document.createElement("option");d.value=n,d.textContent=n,e.appendChild(d)})}catch(a){console.error("Ошибка при получении категорий:",a.message)}document.querySelector(".filter-form").addEventListener("submit",async a=>{a.preventDefault();const n=document.querySelector(".keyword-input"),d=e.value,c={keyword:n.value||null,category:d==="Show all"?null:d,page:1,limit:6};localStorage.setItem("filters",JSON.stringify(c));try{let u;if(!c.keyword&&c.category===null?u=await s.getAllProducts(c.page,c.limit):c.keyword?u=await s.getProductsByName(c.keyword,c.category,c.page,c.limit):u=await s.getProductsInCategories(c.category,c.page,c.limit),console.log("Полученные продукты:",u),u.totalPages===0)(localStorage.getItem("noResultsMessageDisplayed")!=="true"||localStorage.getItem("noResultsMessageDisplayed")!==!0)&&ne();else{const R=L(u.results),_=document.querySelector(".js-products-list");_.innerHTML=R,S(),r(),localStorage.setItem("noResultsMessageDisplayed","false")}}catch(u){console.error("Ошибка при получении продуктов:",u.message)}});function r(){const a=document.querySelector(".filters-title"),n=document.querySelector(".filters-text");a&&a.remove(),n&&n.remove(),localStorage.setItem("noResultsMessageDisplayed","true")}const o={keyword:null,category:null,page:1,limit:6};localStorage.setItem("filters",JSON.stringify(o))});const A=document.querySelector(".input-box"),M=document.querySelector(".keyword-input");M.addEventListener("focus",re);M.addEventListener("blur",ae);function re(){A.classList.add("focus-within")}function ae(){A.classList.remove("focus-within")}function ne(){if(localStorage.getItem("noResultsMessageDisplayed")==="true"||localStorage.getItem("noResultsMessageDisplayed")===!0)return;const s=document.querySelector(".js-products-list"),e=document.createElement("h2");e.textContent="Nothing was found for the selected ",e.classList.add("filters-title");const t=document.createElement("span");t.textContent="filters",t.classList.add("filters-span"),e.appendChild(t);const r=document.createElement("p");r.textContent="Try adjusting your search parameters or browse our range by other criteria to find the perfect product for you.",r.classList.add("filters-text"),s.innerHTML="",s.insertAdjacentElement("afterend",e),e.insertAdjacentElement("afterend",r),localStorage.setItem("noResultsMessageDisplayed","true")}const ce=document.querySelector(".js-products-list"),ie=new y,le=document.getElementById("pagination"),de={totalItems:540,itemsPerPage:6,visiblePages:4,page:1,centerAlign:!0,template:{prev:'<a href="#" class="tui-page-btn tui-prev"><svg class="icon-svg"><use href="prev.svg#prev"></use></svg></a>',firstPageLink:'<a href="#" class="tui-page-btn tui-first">{{page}}</a>',page:'<a href="#" class="tui-page-btn tui-{{type}}">{{page}}</a>',currentPage:'<strong class="tui-page-btn tui-is-selected">{{page}}</strong>',moveButton:'<a href="#" class="tui-page-btn tui-{{type}}"><span class="tui-ico-{{type}}">{{type}}</span></a>',disabledMoveButton:'<span class="tui-page-btn tui-is-disabled tui-{{type}}"><span class="tui-ico-{{type}}">{{type}}</span></span>',moreButton:'<a href="#" class="tui-page-btn tui-{{type}}-is-ellip"><span class="tui-ico-ellip">...</span></a>',lastPageLink:'<a href="#" class="tui-page-btn tui-last">{{page}}</a>',next:'<a href="#" class="tui-page-btn tui-next"><svg class="icon-svg"><use href="next.svg#next"></use></svg></a>'}},ue=new N(le,de);ue.on("beforeMove",async s=>{const e=s.page,t=await ie.getAllProducts(e,6);I(t.results,ce),S()});const pe=new y,me=document.getElementById("subscriptionForm"),ge=document.querySelector(".footer-form-input");function fe(s){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)}async function ye(s){s.preventDefault();const e=ge.value;if(fe(e))try{const t=await pe.createSubscription(e);console.log("Success:",t),h.Notify.success("Subscription completed successfully")}catch(t){console.error("Error:",t),h.Notify.failure("Error during subscription")}else h.Notify.warning("Please enter a valid email address.");s.target.reset()}me.addEventListener("submit",ye);
//# sourceMappingURL=commonHelpers2.js.map
