{"version":3,"file":"local-storage-3f1f4934.js","sources":["../../src/js/requests.js","../../src/js/local-storage.js"],"sourcesContent":["import axios from 'axios';\n\nclass ApiService {\n  constructor() {\n    this.BASE_URL = 'https://food-boutique.b.goit.study/api';\n  }\n\n  async getProductsByName(name, categories, page = 1, limit = 6) {\n    const params = new URLSearchParams({\n      keyword: name,\n      category: categories,\n      page,\n      limit,\n    });\n    try {\n      const resp = await axios.get(`${this.BASE_URL}/products?${params}`);\n      return resp.data;\n    } catch {\n      console.error('Помилка при отриманні продуктів:', error.message);\n      throw error;\n    }\n  }\n\n  async getAllProducts(page = 1, limit = 6) {\n    try {\n      const response = await axios.get(`${this.BASE_URL}/products`, {\n        params: {\n          page,\n          limit,\n        },\n      });\n\n      return response.data;\n    } catch (error) {\n      console.error('Помилка при отриманні всіх продуктів:', error.message);\n      throw error;\n    }\n  }\n\n  async getPopularProducts(limit) {\n    try {\n      const params = {\n        limit,\n      };\n\n      const response = await axios.get(`${this.BASE_URL}/products/popular`, {\n        params,\n      });\n\n      return response.data;\n    } catch (error) {\n      console.error(\n        'Помилка при отриманні популярних продуктів:',\n        error.message\n      );\n      throw error;\n    }\n  }\n\n  async getDiscountedProducts() {\n    try {\n      const response = await axios.get(`${this.BASE_URL}/products/discount`);\n\n      return response.data;\n    } catch (error) {\n      console.error(\n        'Помилка при отриманні продуктів зі знижкою:',\n        error.message\n      );\n      throw error;\n    }\n  }\n\n  async getProductsByCategory() {\n    try {\n      const response = await axios.get(`${this.BASE_URL}/products/categories`);\n\n      return response.data;\n    } catch (error) {\n      console.error(\n        'Помилка при отриманні продуктів за категорією:',\n        error.message\n      );\n      throw error;\n    }\n  }\n\n  // add for Viacheslav\n  async getProductsInCategories(categories, page = 1, limit = 6) {\n    try {\n      const params = new URLSearchParams({\n        category: categories,\n        page,\n        limit,\n      });\n      const response = await axios.get(`${this.BASE_URL}/products?${params}`);\n\n      return response.data;\n    } catch (error) {\n      console.error(\n        'Помилка при отриманні продуктів за категорією(при оновленні сторінки): ',\n        error.message\n      );\n      throw error;\n    }\n  }\n\n  async getProductById(productId) {\n    try {\n      const response = await axios.get(\n        `${this.BASE_URL}/products/${productId}`\n      );\n\n      return response.data;\n    } catch (error) {\n      console.error('Помилка при отриманні продукта за айді:', error.message);\n      throw error;\n    }\n  }\n\n  async createNewOrder(orderData) {\n    try {\n      const response = await axios.post(`${this.BASE_URL}/orders`, orderData);\n\n      return response.data;\n    } catch (error) {\n      console.error('Помилка при створенні нового замовлення:', error.message);\n      throw error;\n    }\n  }\n\n  async createSubscription(email) {\n    try {\n      const response = await axios.post(`${this.BASE_URL}/subscriptions`, {\n        email,\n      });\n\n      return response.data;\n    } catch (error) {\n      // console.error('Помилка при створенні підписки:', error.message);\n      // throw error;\n      if (error.response && error.response.status === 409) {\n        // Возвращаем информацию о конфликте (если email уже существует)\n        return { conflict: true };\n      }\n\n      console.error('Error during subscription:', error.message);\n      throw error;\n    }\n    }\n  }\n\n\nexport default ApiService;\n","export class ShopStorage {\n  constructor(storageBasketName) {\n    this.storageBasketName = storageBasketName;\n    this.initStorage();\n  }\n\n  initStorage() {\n    if (this.getAllProducts()) {\n      return;\n    }\n    this.#writeToLocalStorage([]);\n  }\n\n  getAllProducts() {\n    return JSON.parse(localStorage.getItem(this.storageBasketName));\n  }\n\n  addProduct(newProduct) {\n    if (!newProduct) {\n      return;\n    }\n    const products = this.getAllProducts();\n    const searchProduct = products.find(item => item._id === newProduct._id);\n    if (!searchProduct) {\n      newProduct.amount = 1;\n      products.push(newProduct);\n    } else {\n      searchProduct.amount += 1;\n    }\n    this.#writeToLocalStorage(products);\n  }\n\n  removeProductById(productId) {\n    const products = this.getAllProducts();\n    const searchProduct = products.find(item => item._id === productId);\n    if (!searchProduct) {\n      return;\n    } else if (searchProduct.amount > 1) {\n      searchProduct.amount -= 1;\n    } else {\n      products.filter(elem => elem._id === searchProduct._id);\n    }\n    this.#writeToLocalStorage(products);\n  }\n\n  removeAllProductsById(productId) {\n    this.#writeToLocalStorage(\n      this.getAllProducts().filter(elem => elem._id !== productId)\n    );\n  }\n\n  removeAllProducts() {\n    this.#writeToLocalStorage([]);\n  }\n\n  #writeToLocalStorage(productArray) {\n    localStorage.setItem(this.storageBasketName, JSON.stringify(productArray));\n  }\n\n  //додатковий метод для видалення одного продукту (для корректної роботи кошика)\n  removeProduct(productId) {\n    const products = this.getAllProducts();\n    const updatedProducts = products.filter(product => product._id !== productId);\n    this.#writeToLocalStorage(updatedProducts);\n  }\n}\n"],"names":["ApiService","name","categories","page","limit","params","axios","error","productId","orderData","email","ShopStorage","storageBasketName","__privateAdd","_writeToLocalStorage","__privateMethod","writeToLocalStorage_fn","newProduct","products","searchProduct","item","elem","updatedProducts","product","productArray"],"mappings":"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"}